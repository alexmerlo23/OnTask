{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexm\\\\VsCodeProjects\\\\School Projects\\\\CEN\\\\SWE semester project\\\\SWE-OnTask\\\\frontend\\\\src\\\\pages\\\\Home.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useAuthContext } from \"../hooks/useAuthContext\";\nimport { useEventsContext } from '../hooks/useEventsContext';\nimport { useClassContext } from '../hooks/useClassContext';\nimport CalendarNav from '../components/CalendarNav';\nimport Calendar from '../components/Calendar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Home = () => {\n  _s();\n\n  const {\n    user\n  } = useAuthContext();\n  const {\n    events = [],\n    dispatch: eventDispatch\n  } = useEventsContext(); // Default to an empty array\n\n  const {\n    classroom\n  } = useClassContext();\n  const currentDate = new Date().toISOString().split('T')[0];\n  const [startDate, setStartDate] = useState(currentDate);\n  const fetchEvents = useCallback(async () => {\n    const response = await fetch('/api/events', {\n      headers: {\n        'Authorization': `Bearer ${user.token}`\n      }\n    });\n    const json = await response.json();\n\n    if (response.ok) {\n      const mappedEvents = json.map(event => ({\n        id: event._id,\n        text: event.text,\n        start: event.start,\n        end: event.end,\n        backColor: event.color || \"#ffffff\",\n        participants: event.participants || 0,\n        type: event.type,\n        classroom: event.classroom\n      }));\n      console.log(\"Mapped Events Array: \", mappedEvents);\n      eventDispatch({\n        type: 'SET_EVENTS',\n        payload: mappedEvents\n      });\n    } else {\n      console.error(\"Error fetching events:\", json);\n    }\n  }, [user, eventDispatch]);\n  useEffect(() => {\n    if (user) {\n      fetchEvents();\n    }\n  }, [fetchEvents, user]); // DELETE event handler\n\n  const handleDeleteEvent = async eventId => {\n    const response = await fetch(`/api/events/${eventId}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Bearer ${user.token}`\n      }\n    });\n\n    if (response.ok) {\n      eventDispatch({\n        type: 'DELETE_EVENT',\n        payload: eventId\n      });\n    } else {\n      console.error(\"Failed to delete event\");\n    }\n  }; // EDIT event handler\n\n\n  const handleEditEvent = async (eventId, updatedEvent) => {\n    const response = await fetch(`/api/events/${eventId}`, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': `Bearer ${user.token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(updatedEvent)\n    });\n\n    if (response.ok) {\n      const json = await response.json();\n      eventDispatch({\n        type: 'EDIT_EVENT',\n        payload: json\n      });\n    } else {\n      console.error(\"Failed to edit event\");\n    }\n\n    window.location.reload();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(CalendarNav, {\n        setStartDate: setStartDate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"calendar\",\n      children: /*#__PURE__*/_jsxDEV(Calendar, {\n        startDate: startDate,\n        events: events,\n        onDeleteEvent: handleDeleteEvent,\n        onEditEvent: handleEditEvent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Home, \"XwGICistho+u5aa3AgDDEAH1Cew=\", false, function () {\n  return [useAuthContext, useEventsContext, useClassContext];\n});\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useAuthContext","useEventsContext","useClassContext","CalendarNav","Calendar","Home","user","events","dispatch","eventDispatch","classroom","currentDate","Date","toISOString","split","startDate","setStartDate","fetchEvents","response","fetch","headers","token","json","ok","mappedEvents","map","event","id","_id","text","start","end","backColor","color","participants","type","console","log","payload","error","handleDeleteEvent","eventId","method","handleEditEvent","updatedEvent","body","JSON","stringify","window","location","reload"],"sources":["C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/SWE-OnTask/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport { useAuthContext } from \"../hooks/useAuthContext\";\r\nimport { useEventsContext } from '../hooks/useEventsContext'; \r\nimport { useClassContext } from '../hooks/useClassContext'\r\nimport CalendarNav from '../components/CalendarNav';\r\nimport Calendar from '../components/Calendar';\r\n\r\nconst Home = () => {\r\n  const { user } = useAuthContext();\r\n  const { events = [], dispatch: eventDispatch } = useEventsContext(); // Default to an empty array\r\n  const { classroom } = useClassContext();\r\n  const currentDate = new Date().toISOString().split('T')[0]; \r\n  const [startDate, setStartDate] = useState(currentDate);\r\n\r\n  const fetchEvents = useCallback(async () => {\r\n    const response = await fetch('/api/events', {\r\n      headers: { 'Authorization': `Bearer ${user.token}` },\r\n    });\r\n    const json = await response.json();\r\n\r\n    if (response.ok) {\r\n      const mappedEvents = json.map(event => ({\r\n        id: event._id,\r\n        text: event.text,\r\n        start: event.start,\r\n        end: event.end,\r\n        backColor: event.color || \"#ffffff\",\r\n        participants: event.participants || 0,\r\n        type: event.type,\r\n        classroom: event.classroom\r\n      }));\r\n      console.log(\"Mapped Events Array: \", mappedEvents); \r\n      eventDispatch({ type: 'SET_EVENTS', payload: mappedEvents });\r\n    } else {\r\n      console.error(\"Error fetching events:\", json);\r\n    }\r\n  }, [user, eventDispatch]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchEvents();\r\n    }\r\n  }, [fetchEvents, user]);\r\n\r\n  // DELETE event handler\r\n  const handleDeleteEvent = async (eventId) => {\r\n    const response = await fetch(`/api/events/${eventId}`, {\r\n      method: 'DELETE',\r\n      headers: { 'Authorization': `Bearer ${user.token}` },\r\n    });\r\n\r\n    if (response.ok) {\r\n      eventDispatch({ type: 'DELETE_EVENT', payload: eventId });\r\n    } else {\r\n      console.error(\"Failed to delete event\");\r\n    }\r\n  };\r\n\r\n  // EDIT event handler\r\n  const handleEditEvent = async (eventId, updatedEvent) => {\r\n    const response = await fetch(`/api/events/${eventId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Authorization': `Bearer ${user.token}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(updatedEvent),\r\n    });\r\n\r\n    if (response.ok) {\r\n      const json = await response.json();\r\n      eventDispatch({ type: 'EDIT_EVENT', payload: json });\r\n    } else {\r\n      console.error(\"Failed to edit event\");\r\n    }\r\n    window.location.reload();\r\n  };\r\n\r\n  return (\r\n    <div className=\"home\">\r\n      <div>\r\n        <CalendarNav setStartDate={setStartDate} />\r\n      </div>\r\n      <div className='calendar'>\r\n        <Calendar \r\n          startDate={startDate} \r\n          events={events} \r\n          onDeleteEvent={handleDeleteEvent} \r\n          onEditEvent={handleEditEvent} \r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
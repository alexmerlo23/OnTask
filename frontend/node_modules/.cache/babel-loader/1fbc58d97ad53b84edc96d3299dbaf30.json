{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexm\\\\VsCodeProjects\\\\School Projects\\\\CEN\\\\SWE semester project\\\\SWE-OnTask\\\\frontend\\\\src\\\\pages\\\\Home.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useAuthContext } from \"../hooks/useAuthContext\";\nimport { useEventsContext } from '../hooks/useEventsContext';\nimport { useClassContext } from '../hooks/useClassContext';\nimport CalendarNav from '../components/CalendarNav';\nimport Calendar from '../components/Calendar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Home = () => {\n  _s();\n\n  const {\n    user\n  } = useAuthContext();\n  const {\n    events = [],\n    dispatch: eventDispatch\n  } = useEventsContext(); // Default to an empty array\n\n  const currentDate = new Date().toISOString().split('T')[0];\n  const [startDate, setStartDate] = useState(currentDate);\n  const fetchEvents = useCallback(async () => {\n    const response = await fetch('/api/events', {\n      headers: {\n        'Authorization': `Bearer ${user.token}`\n      }\n    });\n    const json = await response.json();\n\n    if (response.ok) {\n      const filteredEvents = json.filter(event => event.classroom === user.code); // Filter by classroom\n\n      const mappedEvents = filteredEvents.map(event => ({\n        id: event._id,\n        text: event.text,\n        start: event.start,\n        end: event.end,\n        backColor: event.color || \"#ffffff\",\n        participants: event.participants || 0,\n        type: event.type,\n        classroom: user.code\n      }));\n      console.log(\"Mapped and Filtered Events Array: \", mappedEvents);\n      eventDispatch({\n        type: 'SET_EVENTS',\n        payload: mappedEvents\n      });\n    } else {\n      console.error(\"Error fetching events:\", json);\n    }\n  }, [user, eventDispatch]);\n  useEffect(() => {\n    if (user) {\n      fetchEvents();\n    }\n  }, [fetchEvents, user]); // DELETE event handler\n\n  const handleDeleteEvent = async eventId => {\n    const response = await fetch(`/api/events/${eventId}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Bearer ${user.token}`\n      }\n    });\n\n    if (response.ok) {\n      eventDispatch({\n        type: 'DELETE_EVENT',\n        payload: eventId\n      });\n    } else {\n      console.error(\"Failed to delete event\");\n    }\n  }; // EDIT event handler\n\n\n  const handleEditEvent = async (eventId, updatedEvent) => {\n    const response = await fetch(`/api/events/${eventId}`, {\n      method: 'PATCH',\n      headers: {\n        'Authorization': `Bearer ${user.token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(updatedEvent)\n    });\n\n    if (response.ok) {\n      const json = await response.json();\n      eventDispatch({\n        type: 'EDIT_EVENT',\n        payload: json\n      });\n    } else {\n      console.error(\"Failed to edit event\");\n    }\n\n    window.location.reload();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(CalendarNav, {\n        setStartDate: setStartDate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"calendar\",\n      children: /*#__PURE__*/_jsxDEV(Calendar, {\n        startDate: startDate,\n        events: events,\n        onDeleteEvent: handleDeleteEvent,\n        onEditEvent: handleEditEvent\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Home, \"ANicqQNtHsV7YmTyqOYDS+cp5SQ=\", false, function () {\n  return [useAuthContext, useEventsContext];\n});\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useAuthContext","useEventsContext","useClassContext","CalendarNav","Calendar","Home","user","events","dispatch","eventDispatch","currentDate","Date","toISOString","split","startDate","setStartDate","fetchEvents","response","fetch","headers","token","json","ok","filteredEvents","filter","event","classroom","code","mappedEvents","map","id","_id","text","start","end","backColor","color","participants","type","console","log","payload","error","handleDeleteEvent","eventId","method","handleEditEvent","updatedEvent","body","JSON","stringify","window","location","reload"],"sources":["C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/SWE-OnTask/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport { useAuthContext } from \"../hooks/useAuthContext\";\r\nimport { useEventsContext } from '../hooks/useEventsContext'; \r\nimport { useClassContext } from '../hooks/useClassContext'\r\nimport CalendarNav from '../components/CalendarNav';\r\nimport Calendar from '../components/Calendar';\r\n\r\nconst Home = () => {\r\n  const { user } = useAuthContext();\r\n  const { events = [], dispatch: eventDispatch } = useEventsContext(); // Default to an empty array\r\n  const currentDate = new Date().toISOString().split('T')[0]; \r\n  const [startDate, setStartDate] = useState(currentDate);\r\n\r\n  const fetchEvents = useCallback(async () => {\r\n    const response = await fetch('/api/events', {\r\n      headers: { 'Authorization': `Bearer ${user.token}` },\r\n    });\r\n    const json = await response.json();\r\n  \r\n    if (response.ok) {\r\n      const filteredEvents = json.filter(event => event.classroom === user.code); // Filter by classroom\r\n      const mappedEvents = filteredEvents.map(event => ({\r\n        id: event._id,\r\n        text: event.text,\r\n        start: event.start,\r\n        end: event.end,\r\n        backColor: event.color || \"#ffffff\",\r\n        participants: event.participants || 0,\r\n        type: event.type,\r\n        classroom: user.code\r\n      }));\r\n      console.log(\"Mapped and Filtered Events Array: \", mappedEvents); \r\n      eventDispatch({ type: 'SET_EVENTS', payload: mappedEvents });\r\n    } else {\r\n      console.error(\"Error fetching events:\", json);\r\n    }\r\n  }, [user, eventDispatch]);\r\n  \r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchEvents();\r\n    }\r\n  }, [fetchEvents, user]);\r\n\r\n  // DELETE event handler\r\n  const handleDeleteEvent = async (eventId) => {\r\n    const response = await fetch(`/api/events/${eventId}`, {\r\n      method: 'DELETE',\r\n      headers: { 'Authorization': `Bearer ${user.token}` },\r\n    });\r\n\r\n    if (response.ok) {\r\n      eventDispatch({ type: 'DELETE_EVENT', payload: eventId });\r\n    } else {\r\n      console.error(\"Failed to delete event\");\r\n    }\r\n  };\r\n\r\n  // EDIT event handler\r\n  const handleEditEvent = async (eventId, updatedEvent) => {\r\n    const response = await fetch(`/api/events/${eventId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Authorization': `Bearer ${user.token}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(updatedEvent),\r\n    });\r\n\r\n    if (response.ok) {\r\n      const json = await response.json();\r\n      eventDispatch({ type: 'EDIT_EVENT', payload: json });\r\n    } else {\r\n      console.error(\"Failed to edit event\");\r\n    }\r\n    window.location.reload();\r\n  };\r\n\r\n  return (\r\n    <div className=\"home\">\r\n      <div>\r\n        <CalendarNav setStartDate={setStartDate} />\r\n      </div>\r\n      <div className='calendar'>\r\n        <Calendar \r\n          startDate={startDate} \r\n          events={events} \r\n          onDeleteEvent={handleDeleteEvent} \r\n          onEditEvent={handleEditEvent} \r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
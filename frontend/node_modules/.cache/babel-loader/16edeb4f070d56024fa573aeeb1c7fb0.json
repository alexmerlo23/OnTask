{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexm\\\\VsCodeProjects\\\\School Projects\\\\CEN\\\\SWE semester project\\\\OnTask\\\\frontend\\\\src\\\\components\\\\JoinClass.js\",\n    _s = $RefreshSig$();\n\nimport { useState } from 'react';\nimport { useAuthContext } from '../hooks/useAuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const JoinClass = () => {\n  _s();\n\n  const [newCode, setNewCode] = useState('');\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const {\n    user,\n    dispatch\n  } = useAuthContext();\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n\n    if (!user) {\n      setError('User is not logged in');\n      setIsLoading(false);\n      return;\n    }\n\n    console.log(user);\n\n    try {\n      const response = await fetch('/api/user', {\n        method: 'PATCH',\n        // or PUT depending on your API design\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${user.token}`\n        },\n        body: JSON.stringify({\n          email: user.email,\n          // Include the user's email for identification\n          newCode: newCode // Include the new code\n\n        })\n      });\n      const json = await response.json();\n\n      if (!response.ok) {\n        throw new Error(json.error || 'Failed to update code');\n      } else {\n        dispatch({\n          type: 'UPDATE_CODE',\n          payload: {\n            code: newCode\n          }\n        });\n      }\n    } catch (err) {\n      setError(err.message || 'An error occurred');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const openModal = () => setIsModalOpen(true);\n\n  const closeModal = () => setIsModalOpen(false);\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: openModal,\n      className: \"create-class-button\",\n      children: \"Join Class\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), isModalOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"join-class\",\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Join a Class\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Class Code:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: newCode,\n            onChange: e => setNewCode(e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"submit\",\n            disabled: isLoading,\n            children: \"Join Class\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 17\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 27\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: closeModal,\n            className: \"close-modal\",\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(JoinClass, \"EngXeKGmRKwOcs5vUNTKUF2EfMo=\", false, function () {\n  return [useAuthContext];\n});\n\n_c = JoinClass;\nexport default JoinClass;\n\nvar _c;\n\n$RefreshReg$(_c, \"JoinClass\");","map":{"version":3,"names":["useState","useAuthContext","JoinClass","newCode","setNewCode","error","setError","isLoading","setIsLoading","isModalOpen","setIsModalOpen","user","dispatch","handleSubmit","e","preventDefault","console","log","response","fetch","method","headers","token","body","JSON","stringify","email","json","ok","Error","type","payload","code","err","message","openModal","closeModal","target","value"],"sources":["C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/OnTask/frontend/src/components/JoinClass.js"],"sourcesContent":["import { useState } from 'react';\r\nimport { useAuthContext } from '../hooks/useAuthContext';\r\n\r\nexport const JoinClass = () => {\r\n  const [newCode, setNewCode] = useState('');\r\n  const [error, setError] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  const { user, dispatch } = useAuthContext();\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    if (!user) {\r\n      setError('User is not logged in');\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    console.log(user)\r\n\r\n    try {\r\n      const response = await fetch('/api/user', {\r\n        method: 'PATCH', // or PUT depending on your API design\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${user.token}`,\r\n          },\r\n          body: JSON.stringify({\r\n            email: user.email,  // Include the user's email for identification\r\n            newCode: newCode,   // Include the new code\r\n          }),\r\n      });\r\n\r\n      const json = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(json.error || 'Failed to update code');\r\n      }\r\n      else {\r\n        dispatch({ type: 'UPDATE_CODE', payload: { code: newCode } });\r\n      }\r\n\r\n    } catch (err) {\r\n      setError(err.message || 'An error occurred');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const openModal = () => setIsModalOpen(true);\r\n  const closeModal = () => setIsModalOpen(false);\r\n\r\n  return (\r\n    <>\r\n      <button onClick={openModal} className=\"create-class-button\">Join Class</button>\r\n\r\n      {isModalOpen && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content\">\r\n            <form className=\"join-class\" onSubmit={handleSubmit}>\r\n              <h3>Join a Class</h3>\r\n\r\n                <label>Class Code:</label>\r\n                <input\r\n                    type=\"text\"\r\n                    value={newCode}\r\n                    onChange={(e) => setNewCode(e.target.value)}\r\n                    required\r\n                />\r\n\r\n                <button type=\"submit\" className=\"submit\" disabled={isLoading}>\r\n                Join Class\r\n                </button>\r\n                {error && <div className=\"error\">{error}</div>}\r\n\r\n                <button type=\"button\" onClick={closeModal} className=\"close-modal\">\r\n                Close\r\n                </button>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default JoinClass;"],"mappings":"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"},"metadata":{},"sourceType":"module"}
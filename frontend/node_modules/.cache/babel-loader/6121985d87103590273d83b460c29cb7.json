{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexm\\\\VsCodeProjects\\\\School Projects\\\\CEN\\\\SWE semester project\\\\SWE-OnTask\\\\frontend\\\\src\\\\components\\\\ClassroomForm.js\",\n    _s = $RefreshSig$();\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ClassroomForm = () => {\n  _s();\n\n  const {\n    dispatch\n  } = useClassContext();\n  const {\n    user\n  } = useAuthContext();\n  const [email, setEmail] = useState(user.email);\n  const [code, setCode] = useState('');\n  const [classroomName, setClassroomName] = useState('');\n  const [error, setError] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    if (!user) {\n      setError('You must be logged in');\n      return;\n    } // Validate form fields\n\n\n    if (!classroomName || !code || !email) {\n      setError('Please fill in all fields');\n      return;\n    }\n\n    try {\n      // First, try to create the classroom\n      const response = await fetch('/api/classes', {\n        method: 'POST',\n        body: JSON.stringify({\n          classroomName,\n          code,\n          email\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${user.token}`\n        }\n      });\n\n      if (!response.ok) {\n        const json = await response.json();\n        setError(json.error || 'Something went wrong');\n        return; // If the class creation fails, do not proceed\n      }\n\n      const json = await response.json();\n      localStorage.setItem('class', JSON.stringify(json));\n      dispatch({\n        type: 'CREATE_CLASS',\n        payload: { ...json,\n          id: json._id\n        }\n      }); // Now try to update the code\n\n      const responseTwo = await fetch('/api/user', {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${user.token}`\n        },\n        body: JSON.stringify({\n          email: user.email,\n          code: code\n        })\n      });\n      const jsonTwo = await responseTwo.json();\n\n      if (!responseTwo.ok) {\n        throw new Error(jsonTwo.error || 'Failed to update class code');\n      }\n\n      localStorage.setItem('class', JSON.stringify(jsonTwo));\n      dispatch({\n        type: 'UPDATE_CODE',\n        payload: {\n          code: code\n        }\n      });\n      window.location.reload(); // Reload page to reflect the new class\n    } catch (error) {\n      console.error('Fetch error:', error);\n      setError('An error occurred while creating the class or updating the code.');\n    }\n  };\n\n  const openModal = () => setIsModalOpen(true);\n\n  const closeModal = () => setIsModalOpen(false);\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: openModal,\n      className: \"create-class-button\",\n      children: \"Create Class\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), isModalOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"create-class\",\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Create a New Class\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Class Name:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            onChange: e => setClassroomName(e.target.value),\n            value: classroomName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Class Code:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            onChange: e => setCode(e.target.value),\n            value: code\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"hidden\",\n            value: email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"submit\",\n            disabled: !classroomName || !code || !email,\n            children: \"Create Class\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: closeModal,\n            className: \"close-modal\",\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n\n_s(ClassroomForm, \"QE7ZLFd9RfCz+Zfycuqpgy0hXcU=\", true);\n\n_c = ClassroomForm;\nexport default ClassroomForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"ClassroomForm\");","map":{"version":3,"names":["ClassroomForm","dispatch","useClassContext","user","useAuthContext","email","setEmail","useState","code","setCode","classroomName","setClassroomName","error","setError","isModalOpen","setIsModalOpen","handleSubmit","e","preventDefault","response","fetch","method","body","JSON","stringify","headers","token","ok","json","localStorage","setItem","type","payload","id","_id","responseTwo","jsonTwo","Error","window","location","reload","console","openModal","closeModal","target","value"],"sources":["C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/SWE-OnTask/frontend/src/components/ClassroomForm.js"],"sourcesContent":["const ClassroomForm = () => {\r\n  const { dispatch } = useClassContext();\r\n  const { user } = useAuthContext();\r\n\r\n  const [email, setEmail] = useState(user.email);\r\n  const [code, setCode] = useState('');\r\n  const [classroomName, setClassroomName] = useState('');\r\n  const [error, setError] = useState(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!user) {\r\n      setError('You must be logged in');\r\n      return;\r\n    }\r\n\r\n    // Validate form fields\r\n    if (!classroomName || !code || !email) {\r\n      setError('Please fill in all fields');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // First, try to create the classroom\r\n      const response = await fetch('/api/classes', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ classroomName, code, email }),\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${user.token}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const json = await response.json();\r\n        setError(json.error || 'Something went wrong');\r\n        return; // If the class creation fails, do not proceed\r\n      }\r\n\r\n      const json = await response.json();\r\n      localStorage.setItem('class', JSON.stringify(json));\r\n      dispatch({ type: 'CREATE_CLASS', payload: { ...json, id: json._id } });\r\n\r\n      // Now try to update the code\r\n      const responseTwo = await fetch('/api/user', {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${user.token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          email: user.email,\r\n          code: code,\r\n        }),\r\n      });\r\n\r\n      const jsonTwo = await responseTwo.json();\r\n\r\n      if (!responseTwo.ok) {\r\n        throw new Error(jsonTwo.error || 'Failed to update class code');\r\n      }\r\n\r\n      localStorage.setItem('class', JSON.stringify(jsonTwo));\r\n      dispatch({ type: 'UPDATE_CODE', payload: { code: code } });\r\n\r\n      window.location.reload(); // Reload page to reflect the new class\r\n\r\n    } catch (error) {\r\n      console.error('Fetch error:', error);\r\n      setError('An error occurred while creating the class or updating the code.');\r\n    }\r\n  };\r\n\r\n  const openModal = () => setIsModalOpen(true);\r\n  const closeModal = () => setIsModalOpen(false);\r\n\r\n  return (\r\n    <>\r\n      <button onClick={openModal} className=\"create-class-button\">Create Class</button>\r\n\r\n      {isModalOpen && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content\">\r\n            <form className=\"create-class\" onSubmit={handleSubmit}>\r\n              <h3>Create a New Class</h3>\r\n\r\n              <label>Class Name:</label>\r\n              <input\r\n                type=\"text\"\r\n                onChange={(e) => setClassroomName(e.target.value)}\r\n                value={classroomName}\r\n              />\r\n\r\n              <label>Class Code:</label>\r\n              <input\r\n                type=\"text\"\r\n                onChange={(e) => setCode(e.target.value)}\r\n                value={code}\r\n              />\r\n\r\n              <input\r\n                type=\"hidden\"\r\n                value={email}\r\n              />\r\n\r\n              <button type=\"submit\" className=\"submit\" disabled={!classroomName || !code || !email}>\r\n                Create Class\r\n              </button>\r\n              {error && <div className=\"error\">{error}</div>}\r\n\r\n              <button type=\"button\" onClick={closeModal} className=\"close-modal\">\r\n                Close\r\n              </button>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ClassroomForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
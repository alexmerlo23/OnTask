{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/OnTask/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/OnTask/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/OnTask/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useAuthContext}from\"../hooks/useAuthContext\";import{useEventsContext}from'../hooks/useEventsContext';import CalendarNav from'../components/CalendarNav';import Calendar from'../components/Calendar';import EventForm from'../components/CalendarForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var _useAuthContext=useAuthContext(),user=_useAuthContext.user;var _useEventsContext=useEventsContext(),events=_useEventsContext.events,eventDispatch=_useEventsContext.dispatch;var currentDate=new Date().toISOString().split('T')[0];var _useState=useState(currentDate),_useState2=_slicedToArray(_useState,2),startDate=_useState2[0],setStartDate=_useState2[1];var fetchEvents=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,json,mappedEvents;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('/api/events',{headers:{'Authorization':\"Bearer \".concat(user.token)}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:json=_context.sent;if(response.ok){mappedEvents=json.map(function(event){return{id:event._id,text:event.text,start:event.start,end:event.end,backColor:event.backColor||\"#ffffff\",participants:event.participants||0};});eventDispatch({type:'SET_EVENTS',payload:mappedEvents});}else{console.error(\"Error fetching events:\",json);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchEvents(){return _ref.apply(this,arguments);};}();useEffect(function(){if(user){fetchEvents();}},[fetchEvents,eventDispatch,user]);// DELETE event handler\nvar handleDeleteEvent=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(eventId){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"/api/events/\".concat(eventId),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(user.token)}});case 2:response=_context2.sent;if(response.ok){eventDispatch({type:'DELETE_EVENT',payload:eventId});}else{console.error(\"Failed to delete event\");}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDeleteEvent(_x){return _ref2.apply(this,arguments);};}();// EDIT event handler\nvar handleEditEvent=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(eventId,updatedEvent){var response,json;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"/api/events/\".concat(eventId),{method:'PATCH',headers:{'Authorization':\"Bearer \".concat(user.token),'Content-Type':'application/json'},body:JSON.stringify(updatedEvent)});case 2:response=_context3.sent;if(!response.ok){_context3.next=10;break;}_context3.next=6;return response.json();case 6:json=_context3.sent;eventDispatch({type:'EDIT_EVENT',payload:json});_context3.next=11;break;case 10:console.error(\"Failed to edit event\");case 11:case\"end\":return _context3.stop();}}},_callee3);}));return function handleEditEvent(_x2,_x3){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"home\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CalendarNav,{setStartDate:setStartDate})}),/*#__PURE__*/_jsx(\"div\",{className:\"calendar\",children:/*#__PURE__*/_jsx(Calendar,{startDate:startDate,events:events,onDeleteEvent:handleDeleteEvent,onEditEvent:handleEditEvent})}),/*#__PURE__*/_jsx(EventForm,{fetchEvents:fetchEvents})]});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","useAuthContext","useEventsContext","CalendarNav","Calendar","EventForm","Home","user","events","eventDispatch","dispatch","currentDate","Date","toISOString","split","startDate","setStartDate","fetchEvents","fetch","headers","token","response","json","ok","mappedEvents","map","event","id","_id","text","start","end","backColor","participants","type","payload","console","error","handleDeleteEvent","eventId","method","handleEditEvent","updatedEvent","body","JSON","stringify"],"sources":["C:/Users/alexm/VsCodeProjects/School Projects/CEN/SWE semester project/OnTask/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuthContext } from \"../hooks/useAuthContext\";\r\nimport { useEventsContext } from '../hooks/useEventsContext'; \r\nimport CalendarNav from '../components/CalendarNav';\r\nimport Calendar from '../components/Calendar';\r\nimport EventForm from '../components/CalendarForm';\r\n\r\nconst Home = () => {\r\n  const { user } = useAuthContext();\r\n  const { events, dispatch: eventDispatch } = useEventsContext();\r\n  const currentDate = new Date().toISOString().split('T')[0]; \r\n  const [startDate, setStartDate] = useState(currentDate);\r\n\r\n  const fetchEvents = async () => {\r\n    const response = await fetch('/api/events', {\r\n      headers: { 'Authorization': `Bearer ${user.token}` },\r\n    });\r\n    const json = await response.json();\r\n\r\n    if (response.ok) {\r\n      const mappedEvents = json.map(event => ({\r\n        id: event._id,\r\n        text: event.text,\r\n        start: event.start,\r\n        end: event.end,\r\n        backColor: event.backColor || \"#ffffff\",\r\n        participants: event.participants || 0,\r\n      }));\r\n      eventDispatch({ type: 'SET_EVENTS', payload: mappedEvents });\r\n    } else {\r\n      console.error(\"Error fetching events:\", json);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchEvents();\r\n    }\r\n  }, [fetchEvents, eventDispatch, user]);\r\n\r\n  // DELETE event handler\r\n  const handleDeleteEvent = async (eventId) => {\r\n    const response = await fetch(`/api/events/${eventId}`, {\r\n      method: 'DELETE',\r\n      headers: { 'Authorization': `Bearer ${user.token}` },\r\n    });\r\n\r\n    if (response.ok) {\r\n      eventDispatch({ type: 'DELETE_EVENT', payload: eventId });\r\n    } else {\r\n      console.error(\"Failed to delete event\");\r\n    }\r\n  };\r\n\r\n  // EDIT event handler\r\n  const handleEditEvent = async (eventId, updatedEvent) => {\r\n    const response = await fetch(`/api/events/${eventId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Authorization': `Bearer ${user.token}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(updatedEvent),\r\n    });\r\n\r\n    if (response.ok) {\r\n      const json = await response.json();\r\n      eventDispatch({ type: 'EDIT_EVENT', payload: json });\r\n    } else {\r\n      console.error(\"Failed to edit event\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"home\">\r\n      <div>\r\n        <CalendarNav setStartDate={setStartDate} />\r\n      </div>\r\n      <div className='calendar'>\r\n        <Calendar \r\n          startDate={startDate} \r\n          events={events} \r\n          onDeleteEvent={handleDeleteEvent} \r\n          onEditEvent={handleEditEvent} \r\n        />\r\n      </div>\r\n      <EventForm fetchEvents={fetchEvents} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}